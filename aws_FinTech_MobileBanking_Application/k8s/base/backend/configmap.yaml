# ============================================================================
# Backend ConfigMap
# ============================================================================
apiVersion: v1
kind: ConfigMap
metadata:
  name: backend-config
  labels:
    app: backend
data:
  spring.profiles.active: "default"
  
  # Server Configuration
  server.servlet.context-path: "/api"
  
  # Database Configuration (URLs only, credentials from secrets)
  spring.datasource.url: "jdbc:postgresql://postgres:5432/banking"
  spring.datasource.hikari.maximum-pool-size: "20"
  spring.datasource.hikari.minimum-idle: "5"
  spring.datasource.hikari.connection-timeout: "20000"
  spring.datasource.hikari.idle-timeout: "300000"
  spring.datasource.hikari.max-lifetime: "1200000"
  
  # Redis Configuration
  spring.data.redis.host: "redis"
  spring.data.redis.port: "6379"
  spring.data.redis.timeout: "2000"
  
  # JPA Configuration
  spring.jpa.hibernate.ddl-auto: "validate"
  spring.jpa.show-sql: "false"
  spring.jpa.properties.hibernate.format_sql: "false"
  spring.jpa.properties.hibernate.jdbc.batch_size: "50"
  spring.jpa.properties.hibernate.order_inserts: "true"
  spring.jpa.properties.hibernate.order_updates: "true"
  
  # Flyway Configuration
  spring.flyway.enabled: "true"
  spring.flyway.baseline-on-migrate: "false"
  
  # Actuator Configuration
  management.endpoints.web.exposure.include: "health,info,prometheus,metrics"
  management.endpoint.health.show-details: "always"
  management.endpoint.health.probes.enabled: "true"
  management.health.livenessState.enabled: "true"
  management.health.readinessState.enabled: "true"
  
  # Logging Configuration
  logging.level.root: "INFO"
  logging.level.com.fintech.banking: "DEBUG"
  logging.pattern.console: "%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] [%X{correlationId}] %-5level %logger{36} - %msg%n"
  
  # JWT Configuration (expiration times)
  jwt.expiration: "3600000"
  jwt.refresh-expiration: "604800000"
  
  # Rate Limiting
  resilience4j.ratelimiter.instances.default.limit-for-period: "100"
  resilience4j.ratelimiter.instances.default.limit-refresh-period: "1s"
  resilience4j.ratelimiter.instances.default.timeout-duration: "0s"
  
  # Circuit Breaker
  resilience4j.circuitbreaker.instances.default.sliding-window-size: "10"
  resilience4j.circuitbreaker.instances.default.failure-rate-threshold: "50"
  resilience4j.circuitbreaker.instances.default.wait-duration-in-open-state: "10000"
