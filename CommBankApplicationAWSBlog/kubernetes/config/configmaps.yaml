apiVersion: v1
kind: ConfigMap
metadata:
  name: app-config
  namespace: commsec
  labels:
    app: commsec
data:
  # Application settings
  SPRING_PROFILES_ACTIVE: "production"
  SERVER_SHUTDOWN: "graceful"

  # Service URLs
  TRADING_SERVICE_URL: "http://trading-service:8081"
  PORTFOLIO_SERVICE_URL: "http://portfolio-service:8082"
  MARKET_DATA_SERVICE_URL: "http://market-data-service:8083"

  # Database connection pool settings
  HIKARI_MAXIMUM_POOL_SIZE: "20"
  HIKARI_MINIMUM_IDLE: "5"
  HIKARI_IDLE_TIMEOUT: "300000"
  HIKARI_CONNECTION_TIMEOUT: "20000"

  # Logging
  LOG_LEVEL_ROOT: "INFO"
  LOG_LEVEL_COMMSEC: "DEBUG"

  # Metrics
  MANAGEMENT_METRICS_EXPORT_PROMETHEUS_ENABLED: "true"
---
apiVersion: v1
kind: ConfigMap
metadata:
  name: nginx-config
  namespace: commsec
  labels:
    app: frontend
data:
  nginx.conf: |
    user nginx;
    worker_processes auto;
    error_log /var/log/nginx/error.log warn;
    pid /var/run/nginx.pid;

    events {
        worker_connections 1024;
    }

    http {
        include /etc/nginx/mime.types;
        default_type application/octet-stream;
        
        sendfile on;
        keepalive_timeout 65;
        gzip on;
        gzip_types text/plain text/css application/json application/javascript;
        
        server {
            listen 80;
            root /usr/share/nginx/html;
            index index.html;
            
            location /health {
                access_log off;
                return 200 "healthy\n";
            }
            
            location / {
                try_files $uri $uri/ /index.html;
            }
        }
    }
